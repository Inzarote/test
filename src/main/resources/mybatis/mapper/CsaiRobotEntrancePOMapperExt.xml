<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="dao.gen.mapper.CsaiRobotEntrancePOMapperExt" >

    <select id="selectRepeatByUniqueKey" resultMap="dao.gen.mapper.CsaiRobotEntrancePOMapper.BaseResultMap" parameterType="map" >
        select
        <include refid="dao.gen.mapper.CsaiRobotEntrancePOMapper.Base_Column_List" />
        from csai_robot_entrance
        where
        robot_id != #{defaultRobotId}
        and corp_id = #{corpId}
        <if test="entranceSourceList != null and entranceSourceList.size() > 0 ">
            and
            <foreach collection="entranceSourceList" item="entranceSource" open="(" close=")" separator="or">
                FIND_IN_SET (#{entranceSource},entrance_source)
            </foreach>
        </if>
        <if test="relatedOneLevelCategoryList != null and relatedOneLevelCategoryList.size() > 0">
            and
            <foreach collection="relatedOneLevelCategoryList" item="relatedOneLevelCategory" open="(" close=")" separator="or" >
                FIND_IN_SET (#{relatedOneLevelCategory},related_one_level_category)
            </foreach>
        </if>
        <if test="relatedBrandList != null and relatedBrandList.size() > 0">
            and
            <foreach collection="relatedBrandList" item="relatedBrand" open="(" close=")" separator="or" >
                FIND_IN_SET (#{relatedBrand},related_brand)
            </foreach>
        </if>
    </select>

    <update id="updateCsaiRobotEntrance"
            parameterType="dao.gen.po.CsaiRobotEntrancePO">
        update csai_robot_entrance
        set
        entrance_name = #{entranceName,jdbcType=VARCHAR},
        entrance_source = #{entranceSource,jdbcType=VARCHAR},
        related_one_level_category = #{relatedOneLevelCategory,jdbcType=VARCHAR},
        related_brand = #{relatedBrand,jdbcType=VARCHAR},
        operator = #{operator,jdbcType=VARCHAR}
        where id = #{id,jdbcType=BIGINT}
        and db_update_time = #{dbUpdateTime}
    </update>

    <update id="updateSwitchById"  parameterType="map">
        update csai_robot_entrance
        set
        effect_switch = #{effectSwitch,jdbcType=TINYINT}
        where id = #{id,jdbcType=BIGINT}
    </update>


    <select id="countRobotEntrance" resultType="java.lang.Integer" parameterType="java.lang.String" >
        select count(*)
        from csai_robot_entrance
        where robot_id = #{robotId}
    </select>

    <select id="selectEntranceListByRobotId"
            resultMap="dao.gen.mapper.CsaiRobotEntrancePOMapper.BaseResultMap"
            parameterType="java.lang.String" >
        select
        <include refid="dao.gen.mapper.CsaiRobotEntrancePOMapper.Base_Column_List" />
        from csai_robot_entrance
        where robot_id = #{robotId}
        order by create_time ASC
    </select>
</mapper>